<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 14.0.1~dev.20251003.1243 (20251003.1243)
 -->
<!-- Title: MoshiSTTLoop Pages: 1 -->
<svg width="1086pt" height="85pt"
 viewBox="0.00 0.00 1086.00 85.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 81)">
<title>MoshiSTTLoop</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-81 1082.34,-81 1082.34,4 -4,4"/>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
<polygon fill="none" stroke="black" points="84.02,-43 0,-43 0,-7 84.02,-7 84.02,-43"/>
<text xml:space="preserve" text-anchor="middle" x="42.01" y="-27.8" font-family="Times,serif" font-size="14.00">Listen cycle</text>
<text xml:space="preserve" text-anchor="middle" x="42.01" y="-13.8" font-family="Times,serif" font-size="14.00">(reset state)</text>
</g>
<!-- stream -->
<g id="node2" class="node">
<title>stream</title>
<polygon fill="none" stroke="black" points="206.23,-77 121.02,-77 121.02,-41 206.23,-41 206.23,-77"/>
<text xml:space="preserve" text-anchor="middle" x="163.63" y="-61.8" font-family="Times,serif" font-size="14.00">InputStream</text>
<text xml:space="preserve" text-anchor="middle" x="163.63" y="-47.8" font-family="Times,serif" font-size="14.00">24kHz</text>
</g>
<!-- start&#45;&gt;stream -->
<g id="edge1" class="edge">
<title>start&#45;&gt;stream</title>
<path fill="none" stroke="black" d="M84.51,-36.8C92.68,-39.12 101.34,-41.58 109.82,-43.99"/>
<polygon fill="black" stroke="black" points="108.76,-47.33 119.34,-46.7 110.68,-40.59 108.76,-47.33"/>
</g>
<!-- block -->
<g id="node3" class="node">
<title>block</title>
<polygon fill="none" stroke="black" points="306.28,-77 243.23,-77 243.23,-41 306.28,-41 306.28,-77"/>
<text xml:space="preserve" text-anchor="middle" x="274.76" y="-61.8" font-family="Times,serif" font-size="14.00">Block N</text>
<text xml:space="preserve" text-anchor="middle" x="274.76" y="-47.8" font-family="Times,serif" font-size="14.00">(80ms)</text>
</g>
<!-- stream&#45;&gt;block -->
<g id="edge2" class="edge">
<title>stream&#45;&gt;block</title>
<path fill="none" stroke="black" d="M206.51,-59C214.76,-59 223.42,-59 231.68,-59"/>
<polygon fill="black" stroke="black" points="231.49,-62.5 241.49,-59 231.49,-55.5 231.49,-62.5"/>
</g>
<!-- rms -->
<g id="node4" class="node">
<title>rms</title>
<polygon fill="none" stroke="black" points="438.61,-77 343.28,-77 343.28,-41 438.61,-41 438.61,-77"/>
<text xml:space="preserve" text-anchor="middle" x="390.95" y="-61.8" font-family="Times,serif" font-size="14.00">RMS / silence</text>
<text xml:space="preserve" text-anchor="middle" x="390.95" y="-47.8" font-family="Times,serif" font-size="14.00">threshold</text>
</g>
<!-- block&#45;&gt;rms -->
<g id="edge3" class="edge">
<title>block&#45;&gt;rms</title>
<path fill="none" stroke="black" d="M306.66,-59C314.47,-59 323.11,-59 331.78,-59"/>
<polygon fill="black" stroke="black" points="331.62,-62.5 341.62,-59 331.62,-55.5 331.62,-62.5"/>
</g>
<!-- encode -->
<g id="node5" class="node">
<title>encode</title>
<polygon fill="none" stroke="black" points="644.58,-77 524.77,-77 524.77,-41 644.58,-41 644.58,-77"/>
<text xml:space="preserve" text-anchor="middle" x="584.67" y="-61.8" font-family="Times,serif" font-size="14.00">Mimi encode_step</text>
<text xml:space="preserve" text-anchor="middle" x="584.67" y="-47.8" font-family="Times,serif" font-size="14.00">(tokens)</text>
</g>
<!-- rms&#45;&gt;encode -->
<g id="edge4" class="edge">
<title>rms&#45;&gt;encode</title>
<path fill="none" stroke="black" d="M438.85,-59C461.25,-59 488.52,-59 513.34,-59"/>
<polygon fill="black" stroke="black" points="513.03,-62.5 523.03,-59 513.03,-55.5 513.03,-62.5"/>
</g>
<!-- gen -->
<g id="node6" class="node">
<title>gen</title>
<polygon fill="none" stroke="black" points="766.4,-77 681.58,-77 681.58,-41 766.4,-41 766.4,-77"/>
<text xml:space="preserve" text-anchor="middle" x="723.99" y="-61.8" font-family="Times,serif" font-size="14.00">LmGen.step</text>
<text xml:space="preserve" text-anchor="middle" x="723.99" y="-47.8" font-family="Times,serif" font-size="14.00">(text token)</text>
</g>
<!-- encode&#45;&gt;gen -->
<g id="edge5" class="edge">
<title>encode&#45;&gt;gen</title>
<path fill="none" stroke="black" d="M644.71,-59C653.1,-59 661.7,-59 669.97,-59"/>
<polygon fill="black" stroke="black" points="669.89,-62.5 679.89,-59 669.89,-55.5 669.89,-62.5"/>
</g>
<!-- decode -->
<g id="node7" class="node">
<title>decode</title>
<polygon fill="none" stroke="black" points="908.21,-77 803.4,-77 803.4,-41 908.21,-41 908.21,-77"/>
<text xml:space="preserve" text-anchor="middle" x="855.8" y="-61.8" font-family="Times,serif" font-size="14.00">Text detokenize</text>
<text xml:space="preserve" text-anchor="middle" x="855.8" y="-47.8" font-family="Times,serif" font-size="14.00">append</text>
</g>
<!-- gen&#45;&gt;decode -->
<g id="edge6" class="edge">
<title>gen&#45;&gt;decode</title>
<path fill="none" stroke="black" d="M766.78,-59C774.73,-59 783.21,-59 791.65,-59"/>
<polygon fill="black" stroke="black" points="791.57,-62.5 801.57,-59 791.57,-55.5 791.57,-62.5"/>
</g>
<!-- stop -->
<g id="node8" class="node">
<title>stop</title>
<polygon fill="none" stroke="black" points="1078.34,-50 945.21,-50 945.21,0 1078.34,0 1078.34,-50"/>
<text xml:space="preserve" text-anchor="middle" x="1011.78" y="-34.8" font-family="Times,serif" font-size="14.00">Stop when</text>
<text xml:space="preserve" text-anchor="middle" x="1011.78" y="-20.8" font-family="Times,serif" font-size="14.00">silence + min speech</text>
<text xml:space="preserve" text-anchor="middle" x="1011.78" y="-6.8" font-family="Times,serif" font-size="14.00">or VAD hits</text>
</g>
<!-- decode&#45;&gt;stop -->
<g id="edge7" class="edge">
<title>decode&#45;&gt;stop</title>
<path fill="none" stroke="black" d="M908.5,-47.58C916.58,-45.8 925.08,-43.92 933.58,-42.05"/>
<polygon fill="black" stroke="black" points="934.23,-45.49 943.24,-39.91 932.72,-38.65 934.23,-45.49"/>
</g>
<!-- stop&#45;&gt;start -->
<g id="edge8" class="edge">
<title>stop&#45;&gt;start</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M944.93,-17.61C917.69,-15.14 885.76,-13 856.8,-13 162.63,-13 162.63,-13 162.63,-13 140.62,-13 116.44,-15.04 95.62,-17.43"/>
<polygon fill="black" stroke="black" points="95.44,-13.93 85.93,-18.61 96.28,-20.88 95.44,-13.93"/>
<text xml:space="preserve" text-anchor="middle" x="481.69" y="-15.8" font-family="Times,serif" font-size="14.00">next turn</text>
</g>
</g>
</svg>
